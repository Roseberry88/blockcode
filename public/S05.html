<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì½”ë”©ìŠ¤íƒ€íŠ¸ - ì½”ë”© ê³¼ì œ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <!-- Blockly ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.0/blockly_compressed.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.0/blocks_compressed.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.0/javascript_compressed.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.0/python_compressed.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.0/msg/ko.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, #4285f4, #2a5298);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .header-nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255,255,255,0.3);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .user-profile:hover {
            background: rgba(255,255,255,0.2);
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .task-list {
            width: 25%;
            background-color: #f0f0f0;
            padding: 1rem;
            overflow-y: auto;
            border-right: 1px solid #ddd;
        }

        .task-categories {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .category-tab {
            padding: 0.5rem 1rem;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .category-tab:hover {
            background-color: #e3f2fd;
        }

        .category-tab.active {
            background-color: #4285f4;
            color: white;
            border-color: #4285f4;
            transform: translateY(-2px);
        }

        .search-box {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 25px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #4285f4;
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .task-item {
            padding: 1rem;
            background-color: white;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            border: 1px solid #ddd;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .task-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(66, 133, 244, 0.1), transparent);
            transition: left 0.5s;
        }

        .task-item:hover::before {
            left: 100%;
        }

        .task-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .task-item.active {
            border: 2px solid #4285f4;
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
        }

        .task-title {
            font-weight: bold;
            margin-bottom: 0.25rem;
            color: #1a73e8;
        }

        .task-meta {
            font-size: 0.8rem;
            color: #666;
        }

        .task-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-top: 0.5rem;
        }

        .status-pending {
            background-color: #ffeaa7;
            color: #2d3436;
        }

        .status-submitted {
            background-color: #81ecec;
            color: #2d3436;
        }

        .status-graded {
            background-color: #a29bfe;
            color: white;
        }

        .task-details {
            width: 75%;
            padding: 1rem;
            background-color: white;
            display: flex;
            flex-direction: column;
        }

        .task-header {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #4285f4;
        }

        .task-description {
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #4285f4;
        }

        .description-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #1a73e8;
        }

        .example-box {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 0.5rem;
            font-family: 'Consolas', monospace;
            white-space: pre;
            font-size: 0.9rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .editor-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #f0f0f0;
            padding: 0.5rem;
            border-radius: 8px 8px 0 0;
        }

        .editor-tab {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .editor-tab:hover {
            background-color: #e3f2fd;
        }

        .editor-tab.active {
            background-color: #4285f4;
            color: white;
            transform: translateY(-2px);
        }

        .code-editor {
            border: 1px solid #ddd;
            min-height: 300px;
            background-color: #f9f9f9;
            margin-bottom: 1rem;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }

        .block-code-area {
            display: none;
            flex-direction: column;
            gap: 0.5rem;
            padding: 1rem;
        }

        .code-block {
            padding: 0.75rem;
            border-radius: 8px;
            color: white;
            display: inline-block;
            margin-left: 20px;
            cursor: move;
            transition: all 0.3s ease;
        }

        .code-block:hover {
            transform: scale(1.05);
        }

        .code-block.yellow {
            background: linear-gradient(135deg, #ffc107, #ff8f00);
        }

        .code-block.blue {
            background: linear-gradient(135deg, #4285f4, #1976d2);
        }

        .code-block.red {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .code-block.green {
            background: linear-gradient(135deg, #4caf50, #388e3c);
        }

        #blocklyDiv {
            height: 100%;
            min-height: 300px;
            width: 100%;
        }

        .code-view {
            display: none;
            height: 300px;
            width: 100%;
            padding: 1rem;
            font-family: 'Consolas', monospace;
            white-space: pre;
            overflow: auto;
            background-color: #2d3748;
            color: #e2e8f0;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            border: none;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .btn-run {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
        }

        .btn-test {
            background: linear-gradient(135deg, #ff9800, #f57400);
            color: white;
        }

        .btn-submit {
            background: linear-gradient(135deg, #4285f4, #1976d2);
            color: white;
        }

        .code-panel {
            margin-top: 1rem;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            padding: 0.75rem;
            border-radius: 8px 8px 0 0;
        }

        .code-title {
            font-weight: bold;
            color: #1a73e8;
        }

        .language-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .language-button {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .language-button:hover {
            transform: translateY(-2px);
        }

        .active-language {
            background-color: #4285f4;
            color: white;
        }

        .inactive-language {
            background-color: white;
            border: 1px solid #ddd;
        }

        .code-content {
            height: 200px;
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            white-space: pre;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }

        .output-panel {
            margin-top: 1rem;
        }

        .output-header {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            padding: 0.75rem;
            font-weight: bold;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #1a73e8;
        }

        .output-content {
            height: 150px;
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            white-space: pre;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }

        .test-case-panel {
            display: none;
            margin-top: 1rem;
        }

        .test-case-header {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            padding: 0.75rem;
            font-weight: bold;
            border-radius: 8px 8px 0 0;
            color: #1a73e8;
        }

        .test-case-content {
            background-color: #f8f9fa;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 0 0 8px 8px;
        }

        .test-case-item {
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            background: white;
            transition: all 0.3s ease;
        }

        .test-case-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .test-case-badge {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 1rem;
        }

        .badge-success {
            background-color: #4caf50;
        }

        .badge-error {
            background-color: #f44336;
        }

        .badge-pending {
            background-color: #9e9e9e;
        }

        .output-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            color: white;
            transition: all 0.3s ease;
        }

        .output-badge:hover {
            transform: scale(1.1);
        }

        .score-badge {
            background: linear-gradient(135deg, #4285f4, #1976d2);
        }

        .feedback-badge {
            background: linear-gradient(135deg, #ff9800, #f57400);
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 15px;
            width: 70%;
            max-width: 700px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #4285f4;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #1a73e8;
        }

        .modal-close {
            cursor: pointer;
            font-size: 1.5rem;
            color: #666;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background-color: #f44336;
            color: white;
        }

        .modal-body {
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .result-summary {
            margin-top: 1rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            border-radius: 10px;
            text-align: center;
            border-left: 5px solid #4285f4;
        }

        .result-score {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .result-pass {
            color: #4caf50;
        }

        .result-fail {
            color: #f44336;
        }

        /* ë¡œë”© ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .navigation-notification {
            position: fixed;
            top: 100px;
            right: 30px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            font-family: Arial, sans-serif;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .loading-skeleton {
            animation: skeleton-loading 1.5s infinite ease-in-out;
        }

        @keyframes skeleton-loading {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .no-assignment-selected {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
            text-align: center;
        }

        .no-assignment-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            color: #ddd;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-nav {
                display: none;
            }
            
            .main-container {
                flex-direction: column;
            }
            
            .task-list, .task-details {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <header>
        <div class="logo" id="logoTitle">ğŸš€ ì½”ë”©ìŠ¤íƒ€íŠ¸: ì½”ë”© ê³¼ì œ</div>
        
        <div class="header-nav">
            <a href="#" class="nav-link" id="dashboardLink">ëŒ€ì‹œë³´ë“œ</a>
            <a href="#" class="nav-link" id="blockCodingLink">ë¸”ë¡ ì½”ë”©</a>
            <a href="#" class="nav-link" id="algorithmLink">ì•Œê³ ë¦¬ì¦˜</a>
            <a href="#" class="nav-link active" id="assignmentsLink">ê³¼ì œ ê´€ë¦¬</a>
            <a href="#" class="nav-link" id="progressLink">í•™ìŠµ í˜„í™©</a>
        </div>

        <div class="user-profile" id="userProfile">
            <span id="userName">ì‚¬ìš©ì</span>
            <div class="avatar" id="userAvatar">U</div>
        </div>
    </header>

    <div class="main-container">
        <!-- ì¢Œì¸¡ ê³¼ì œ ëª©ë¡ -->
        <div class="task-list">
            <h3>ê³¼ì œ ëª©ë¡</h3>

            <!-- ê³¼ì œ ì¹´í…Œê³ ë¦¬ íƒ­ -->
            <div class="task-categories">
                <div class="category-tab active" data-category="all">ì „ì²´</div>
                <div class="category-tab" data-category="pending">ë¯¸ì™„ë£Œ</div>
                <div class="category-tab" data-category="submitted">ì œì¶œì™„ë£Œ</div>
            </div>

            <!-- ê³¼ì œ ê²€ìƒ‰ -->
            <input type="text" class="search-box" placeholder="ê³¼ì œ ê²€ìƒ‰..." id="searchBox">

            <!-- ê³¼ì œ ëª©ë¡ í•­ëª©ë“¤ -->
            <div class="task-items" id="taskItems">
                <!-- ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤ -->
                <div class="loading-skeleton" id="loadingSkeleton">
                    <div class="task-item" style="background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: skeleton-loading 1.5s infinite;">
                        <div style="height: 20px; background: rgba(255,255,255,0.8); margin-bottom: 8px; border-radius: 4px;"></div>
                        <div style="height: 14px; background: rgba(255,255,255,0.8); margin-bottom: 4px; border-radius: 4px; width: 70%;"></div>
                    </div>
                    <div class="task-item" style="background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: skeleton-loading 1.5s infinite;">
                        <div style="height: 20px; background: rgba(255,255,255,0.8); margin-bottom: 8px; border-radius: 4px;"></div>
                        <div style="height: 14px; background: rgba(255,255,255,0.8); margin-bottom: 4px; border-radius: 4px; width: 70%;"></div>
                    </div>
                </div>

                <!-- ë¹ˆ ìƒíƒœ ë©”ì‹œì§€ -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-state-icon">ğŸ“</div>
                    <h3>ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p>ë“±ë¡ëœ ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- ìš°ì¸¡ ê³¼ì œ ìƒì„¸ íŒ¨ë„ -->
        <div class="task-details" id="taskDetails">
            <!-- ê³¼ì œê°€ ì„ íƒë˜ì§€ ì•Šì€ ìƒíƒœ -->
            <div class="no-assignment-selected" id="noAssignmentSelected">
                <div class="no-assignment-icon">ğŸ“š</div>
                <h2>ê³¼ì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
                <p>ì™¼ìª½ ëª©ë¡ì—ì„œ ê³¼ì œë¥¼ ì„ íƒí•˜ë©´ ìƒì„¸ ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <!-- ê³¼ì œ ìƒì„¸ ë‚´ìš© (ì²˜ìŒì—ëŠ” ìˆ¨ê²¨ì§) -->
            <div id="assignmentContent" style="display: none;">
                <!-- ê³¼ì œ ì œëª© ë° ì •ë³´ -->
                <div class="task-header">
                    <h2 id="currentTaskTitle">ê³¼ì œ ì œëª©</h2>
                    <div class="task-meta" id="currentTaskMeta">ê³¼ì œ ì •ë³´</div>
                </div>

                <!-- ê³¼ì œ ì„¤ëª… ì˜ì—­ -->
                <div class="task-description">
                    <div class="description-title">ë¬¸ì œ ì„¤ëª…</div>
                    <p id="taskDescription">ê³¼ì œ ì„¤ëª…ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                    <div id="problemStatement" style="margin-top: 1rem;"></div>

                    <div class="description-title" style="margin-top: 1rem;">ì…ì¶œë ¥ ì˜ˆì‹œ</div>
                    <div class="example-box" id="taskExample">ì˜ˆì‹œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                </div>

                <!-- ì½”ë“œ ì—ë””í„° ì˜ì—­ -->
                <div class="editor-tabs">
                    <div class="editor-tab active" data-editor="block">ë¸”ë¡</div>
                    <div class="editor-tab" data-editor="code">ì½”ë“œ</div>
                </div>

                <div class="code-editor">
                    <!-- ë¸”ë¡ ì½”ë“œ ì˜ì—­ -->
                    <div id="blocklyDiv"></div>
                    <div id="codeView" class="code-view"></div>
                </div>

                <!-- ì½”ë“œ í‘œì‹œ ì˜ì—­ -->
                <div class="code-panel">
                    <div class="code-header">
                        <div class="code-title">ì‹¤ì œ ì½”ë“œ</div>
                        <div class="language-buttons">
                            <div class="language-button active-language" id="pythonButton">Python</div>
                            <div class="language-button inactive-language" id="javascriptButton">JavaScript</div>
                        </div>
                    </div>
                    <div class="code-content" id="codeContent"></div>
                </div>

                <!-- ì¶œë ¥ ì˜ì—­ -->
                <div class="output-panel">
                    <div class="output-header">
                        <span>ì‹¤í–‰ ê²°ê³¼</span>
                        <div>
                            <span class="output-badge score-badge" id="scoreDisplay" style="display: none;">ì ìˆ˜: 0/100</span>
                            <span class="output-badge feedback-badge" id="feedbackButton" style="display: none;">í”¼ë“œë°± ë³´ê¸°</span>
                        </div>
                    </div>
                    <div class="output-content" id="outputContent"></div>
                </div>

                <!-- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ íŒ¨ë„ -->
                <div class="test-case-panel" id="testCasePanel">
                    <div class="test-case-header">í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê²°ê³¼</div>
                    <div class="test-case-content" id="testCaseContent">
                        <!-- ì—¬ê¸°ì— í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ì‹¤í–‰ ë° ì œì¶œ ë²„íŠ¼ -->
                <div class="action-buttons">
                    <button class="btn btn-run" id="runButton">ì‹¤í–‰</button>
                    <button class="btn btn-test" id="testButton">í…ŒìŠ¤íŠ¸</button>
                    <button class="btn btn-submit" id="submitButton">ì œì¶œ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- í”¼ë“œë°± ëª¨ë‹¬ -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ì½”ë“œ í”¼ë“œë°±</div>
                <span class="modal-close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body" id="feedbackContent">
                <!-- ì—¬ê¸°ì— í”¼ë“œë°± ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-submit" id="confirmModal">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- XML ì •ì˜ (Blockly íˆ´ë°•ìŠ¤) -->
    <xml id="toolbox" style="display: none">
        <category name="ì œì–´" colour="#ffc107">
            <block type="controls_if"></block>
            <block type="controls_repeat_ext">
                <value name="TIMES">
                    <shadow type="math_number">
                        <field name="NUM">10</field>
                    </shadow>
                </value>
            </block>
            <block type="controls_for">
                <value name="FROM">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="TO">
                    <shadow type="math_number">
                        <field name="NUM">10</field>
                    </shadow>
                </value>
                <value name="BY">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
            </block>
            <block type="controls_forEach"></block>
        </category>
        <category name="ì…ì¶œë ¥" colour="#4285f4">
            <block type="text_print">
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_prompt_ext">
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”</field>
                    </shadow>
                </value>
            </block>
        </category>
        <category name="ë…¼ë¦¬" colour="#34a853">
            <block type="logic_compare"></block>
            <block type="logic_operation"></block>
            <block type="logic_boolean"></block>
        </category>
        <category name="ìˆ˜í•™" colour="#ea4335">
            <block type="math_number">
                <field name="NUM">0</field>
            </block>
            <block type="math_arithmetic">
                <value name="A">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="B">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
            </block>
        </category>
        <category name="í…ìŠ¤íŠ¸" colour="#9c27b0">
            <block type="text">
                <field name="TEXT"></field>
            </block>
            <block type="text_join"></block>
            <block type="text_append">
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT"></field>
                    </shadow>
                </value>
            </block>
        </category>
        <category name="ë³€ìˆ˜" colour="#ff5722" custom="VARIABLE"></category>
        <category name="í•¨ìˆ˜" colour="#795548" custom="PROCEDURE"></category>
    </xml>

    <script>
        // í†µí•© ë„¤ë¹„ê²Œì´ì…˜ ì‹œìŠ¤í…œ
        class NavigationManager {
            constructor() {
                this.currentUser = null;
                this.routes = {
                    'dashboard': '/dashboard',
                    'block-coding': '/block-coding', 
                    'algorithm': '/algorithm',
                    'assignments': '/assignments',
                    'progress': '/progress',
                    'teacher-dashboard': '/teacher-dashboard',
                    'create-assignment': '/create-assignment',
                    'review-submissions': '/review-submissions',
                    'student-analytics': '/student-analytics',
                    'student-management': '/student-management',
                    'login': '/login'
                };
                
                this.init();
            }

            init() {
                this.loadUserInfo();
                this.setupEventListeners();
                this.updateNavigationUI();
            }

            loadUserInfo() {
                const token = localStorage.getItem('authToken');
                const userJSON = localStorage.getItem('user');

                if (!token || !userJSON) {
                    this.redirectToLogin();
                    return false;
                }

                try {
                    this.currentUser = JSON.parse(userJSON);
                    return true;
                } catch (error) {
                    console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', error);
                    this.clearAuthAndRedirect();
                    return false;
                }
            }

            setupEventListeners() {
                // ë¡œê³  í´ë¦­ ì´ë²¤íŠ¸
                const logoTitle = document.getElementById('logoTitle');
                if (logoTitle) {
                    logoTitle.addEventListener('click', () => {
                        this.navigateToDashboard();
                    });
                }

                // ë„¤ë¹„ê²Œì´ì…˜ ë§í¬ë“¤
                const navLinks = {
                    'dashboardLink': () => this.navigateToDashboard(),
                    'blockCodingLink': () => this.navigateTo('block-coding'),
                    'algorithmLink': () => this.navigateTo('algorithm'),
                    'assignmentsLink': () => {}, // í˜„ì¬ í˜ì´ì§€
                    'progressLink': () => this.navigateTo('progress')
                };

                Object.keys(navLinks).forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('click', (e) => {
                            e.preventDefault();
                            navLinks[id]();
                        });
                    }
                });

                // ì‚¬ìš©ì í”„ë¡œí•„ í´ë¦­ ì´ë²¤íŠ¸
                const userProfile = document.getElementById('userProfile');
                if (userProfile) {
                    userProfile.addEventListener('click', () => {
                        this.handleLogout();
                    });
                }
            }

            updateNavigationUI() {
                if (!this.currentUser) return;

                // ì‚¬ìš©ì ì´ë¦„ ì—…ë°ì´íŠ¸
                const userName = document.getElementById('userName');
                if (userName) {
                    userName.textContent = this.currentUser.name || 'ì‚¬ìš©ì';
                }

                // ì‚¬ìš©ì ì•„ë°”íƒ€ ì—…ë°ì´íŠ¸
                const userAvatar = document.getElementById('userAvatar');
                if (userAvatar) {
                    const initial = (this.currentUser.name || 'U').charAt(0).toUpperCase();
                    userAvatar.textContent = initial;
                }
            }

            navigateToDashboard() {
                if (this.currentUser.role === 'professor' || this.currentUser.role === 'admin') {
                    this.navigateTo('teacher-dashboard');
                } else {
                    this.navigateTo('dashboard');
                }
            }

            navigateTo(routeName) {
                if (this.routes[routeName]) {
                    this.showLoading();
                    
                    setTimeout(() => {
                        window.location.href = this.routes[routeName];
                    }, 300);
                } else {
                    console.error(`Route not found: ${routeName}`);
                }
            }

            redirectToLogin() {
                this.showNotification('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'error');
                setTimeout(() => {
                    window.location.href = this.routes.login;
                }, 1500);
            }

            clearAuthAndRedirect() {
                localStorage.clear();
                this.redirectToLogin();
            }

            handleLogout() {
                if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    this.showLoading();
                    
                    const token = localStorage.getItem('authToken');
                    
                    fetch('/api/logout', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer ' + token,
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(() => {
                        localStorage.clear();
                        this.showNotification('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
                        setTimeout(() => {
                            window.location.href = this.routes.login;
                        }, 1000);
                    })
                    .catch((error) => {
                        console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                        localStorage.clear();
                        window.location.href = this.routes.login;
                    })
                    .finally(() => {
                        this.hideLoading();
                    });
                }
            }

            showLoading() {
                let loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.add('active');
                }
            }

            hideLoading() {
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.remove('active');
                }
            }

            showNotification(message, type = 'success') {
                const existingNotification = document.getElementById('navigationNotification');
                if (existingNotification) {
                    existingNotification.remove();
                }

                const notification = document.createElement('div');
                notification.id = 'navigationNotification';
                notification.className = 'navigation-notification';
                notification.textContent = message;

                const backgroundColor = type === 'error' 
                    ? 'linear-gradient(135deg, #f44336, #d32f2f)' 
                    : 'linear-gradient(135deg, #4CAF50, #45a049)';

                notification.style.background = backgroundColor;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, 100);

                setTimeout(() => {
                    notification.style.transform = 'translateX(400px)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case '1':
                                e.preventDefault();
                                this.navigateToDashboard();
                                break;
                            case '2':
                                e.preventDefault();
                                this.navigateTo('block-coding');
                                break;
                            case '3':
                                e.preventDefault();
                                this.navigateTo('algorithm');
                                break;
                            case '4':
                                e.preventDefault();
                                // í˜„ì¬ í˜ì´ì§€ì´ë¯€ë¡œ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
                                break;
                            case '5':
                                e.preventDefault();
                                this.navigateTo('progress');
                                break;
                        }
                    }
                });
            }
        }

        // ê³¼ì œ ê´€ë¦¬ ì‹œìŠ¤í…œ
        class AssignmentManager {
            constructor() {
                this.assignments = [];
                this.currentAssignment = null;
                this.currentSubmission = null;
                this.currentEditorMode = 'block';
                this.testResults = [];
                this.workspace = null;
                
                this.init();
            }

            async init() {
                try {
                    await this.loadAssignments();
                    this.initBlockly();
                    this.setupEventListeners();
                } catch (error) {
                    console.error('ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                    navigationManager.showNotification('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            async loadAssignments() {
                try {
                    const token = localStorage.getItem('authToken');
                    if (!token) {
                        throw new Error('ì¸ì¦ í† í°ì´ ì—†ìŠµë‹ˆë‹¤.');
                    }
                    
                    console.log('Loading assignments...');
                    
                    const response = await fetch('/api/assignments', {
                        method: 'GET',
                        headers: {
                            'Authorization': 'Bearer ' + token,
                            'Content-Type': 'application/json'
                        }
                    });

                    console.log('Assignments response status:', response.status);

                    if (!response.ok) {
                        if (response.status === 401) {
                            // í† í° ë§Œë£Œ
                            localStorage.clear();
                            navigationManager.redirectToLogin();
                            return;
                        }
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const result = await response.json();
                    console.log('Assignments result:', result);
                    
                    if (result.success) {
                        this.assignments = result.assignments || [];
                        console.log('Loaded assignments:', this.assignments.length);
                        this.renderAssignmentList();
                    } else {
                        throw new Error(result.message || 'ê³¼ì œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('ê³¼ì œ ë¡œë“œ ì˜¤ë¥˜:', error);
                    this.showEmptyState();
                    navigationManager.showNotification('ê³¼ì œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                }
            }

            renderAssignmentList() {
                const taskItems = document.getElementById('taskItems');
                const loadingSkeleton = document.getElementById('loadingSkeleton');
                const emptyState = document.getElementById('emptyState');

                // ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤ ìˆ¨ê¸°ê¸°
                if (loadingSkeleton) {
                    loadingSkeleton.style.display = 'none';
                }

                if (this.assignments.length === 0) {
                    this.showEmptyState();
                    return;
                }

                // ë¹ˆ ìƒíƒœ ìˆ¨ê¸°ê¸°
                if (emptyState) {
                    emptyState.style.display = 'none';
                }

                // ê³¼ì œ ëª©ë¡ ìƒì„±
                taskItems.innerHTML = '';
                
                this.assignments.forEach((assignment, index) => {
                    const taskItem = this.createAssignmentItem(assignment, index);
                    taskItems.appendChild(taskItem);
                });
            }

            createAssignmentItem(assignment, index) {
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.setAttribute('data-assignment-id', assignment.assignment_id);

                // ì œì¶œ ìƒíƒœ í™•ì¸
                let statusClass = 'status-pending';
                let statusText = 'ë¯¸ì™„ë£Œ';
                
                if (assignment.submission) {
                    if (assignment.submission.score !== null && assignment.submission.graded_at) {
                        statusClass = 'status-graded';
                        statusText = `ì±„ì ì™„ë£Œ (${assignment.submission.score}ì )`;
                    } else {
                        statusClass = 'status-submitted';
                        statusText = 'ì œì¶œì™„ë£Œ';
                    }
                }

                // ë§ˆê°ì¼ ê³„ì‚°
                let dueDateText = 'ë§ˆê°ì¼ ì—†ìŒ';
                if (assignment.due_date) {
                    const dueDate = new Date(assignment.due_date);
                    const now = new Date();
                    const diffTime = dueDate - now;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays < 0) {
                        dueDateText = 'ë§ˆê°ë¨';
                    } else if (diffDays === 0) {
                        dueDateText = 'ì˜¤ëŠ˜ ë§ˆê°';
                    } else {
                        dueDateText = `${diffDays}ì¼ í›„`;
                    }
                }

                // ë‚œì´ë„ í…ìŠ¤íŠ¸ ë³€í™˜
                const difficultyMap = {
                    'easy': 'ì´ˆê¸‰',
                    'medium': 'ì¤‘ê¸‰',
                    'hard': 'ê³ ê¸‰'
                };
                const difficultyText = difficultyMap[assignment.difficulty_level] || assignment.difficulty_level;

                taskItem.innerHTML = `
                    <div class="task-title">${assignment.title}</div>
                    <div class="task-meta">ë‚œì´ë„: ${difficultyText} | ë§ˆê°: ${dueDateText}</div>
                    <div class="task-meta">ì¶œì œì: ${assignment.creator_name}</div>
                    <div class="task-status ${statusClass}">${statusText}</div>
                `;

                // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                taskItem.addEventListener('click', () => {
                    this.selectAssignment(assignment);
                    
                    // í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                    document.querySelectorAll('.task-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    taskItem.classList.add('active');
                });

                return taskItem;
            }

            showEmptyState() {
                const taskItems = document.getElementById('taskItems');
                const loadingSkeleton = document.getElementById('loadingSkeleton');
                const emptyState = document.getElementById('emptyState');

                if (loadingSkeleton) {
                    loadingSkeleton.style.display = 'none';
                }
                
                taskItems.innerHTML = '';
                
                if (emptyState) {
                    emptyState.style.display = 'block';
                }
            }

            async selectAssignment(assignment) {
                try {
                    this.currentAssignment = assignment;
                    this.currentSubmission = assignment.submission || null;

                    // ê³¼ì œ ìƒì„¸ ì •ë³´ ë¡œë“œ
                    await this.loadAssignmentDetails(assignment.assignment_id);
                    
                    // UI ì—…ë°ì´íŠ¸
                    this.showAssignmentDetails();
                    
                } catch (error) {
                    console.error('ê³¼ì œ ì„ íƒ ì˜¤ë¥˜:', error);
                    navigationManager.showNotification('ê³¼ì œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            async loadAssignmentDetails(assignmentId) {
                try {
                    const token = localStorage.getItem('authToken');
                    
                    const response = await fetch(`/api/assignments/${assignmentId}`, {
                        method: 'GET',
                        headers: {
                            'Authorization': 'Bearer ' + token,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.success) {
                        this.currentAssignment = { ...this.currentAssignment, ...result.assignment };
                        this.currentSubmission = result.assignment.submission || null;
                    } else {
                        throw new Error(result.message || 'ê³¼ì œ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('ê³¼ì œ ìƒì„¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                    throw error;
                }
            }

            showAssignmentDetails() {
                const noAssignmentSelected = document.getElementById('noAssignmentSelected');
                const assignmentContent = document.getElementById('assignmentContent');

                // ì„ íƒ ì•ˆë‚´ ìˆ¨ê¸°ê¸°
                if (noAssignmentSelected) {
                    noAssignmentSelected.style.display = 'none';
                }

                // ê³¼ì œ ë‚´ìš© í‘œì‹œ
                if (assignmentContent) {
                    assignmentContent.style.display = 'block';
                }

                // ê³¼ì œ ì •ë³´ ì—…ë°ì´íŠ¸
                this.updateAssignmentInfo();
                
                // ê²°ê³¼ íŒ¨ë„ ì´ˆê¸°í™”
                this.resetResultPanels();
                
                // ê¸°ì¡´ ì œì¶œë¬¼ì´ ìˆìœ¼ë©´ ì ìˆ˜ í‘œì‹œ
                if (this.currentSubmission && this.currentSubmission.score !== null) {
                    this.showSubmissionResult();
                }
            }

            updateAssignmentInfo() {
                // ì œëª©
                const titleEl = document.getElementById('currentTaskTitle');
                if (titleEl) {
                    titleEl.textContent = this.currentAssignment.title || 'ê³¼ì œ ì œëª©';
                }

                // ë©”íƒ€ ì •ë³´
                const metaEl = document.getElementById('currentTaskMeta');
                if (metaEl) {
                    const difficultyMap = {
                        'easy': 'ì´ˆê¸‰',
                        'medium': 'ì¤‘ê¸‰',
                        'hard': 'ê³ ê¸‰'
                    };
                    const difficulty = difficultyMap[this.currentAssignment.difficulty_level] || this.currentAssignment.difficulty_level;
                    
                    let dueDateStr = 'ë§ˆê°ì¼ ì—†ìŒ';
                    if (this.currentAssignment.due_date) {
                        const dueDate = new Date(this.currentAssignment.due_date);
                        dueDateStr = dueDate.toLocaleDateString('ko-KR', {
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                    }

                    metaEl.textContent = `ë‚œì´ë„: ${difficulty} | ì¶œì œì: ${this.currentAssignment.creator_name} | ë§ˆê°: ${dueDateStr}`;
                }

                // ì„¤ëª…
                const descEl = document.getElementById('taskDescription');
                if (descEl) {
                    descEl.textContent = this.currentAssignment.description || 'ê³¼ì œ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.';
                }

                // ë¬¸ì œ ëª…ì„¸
                const problemEl = document.getElementById('problemStatement');
                if (problemEl) {
                    problemEl.innerHTML = `<div class="description-title">ë¬¸ì œ ëª…ì„¸</div><p>${this.currentAssignment.problem_statement || 'ë¬¸ì œ ëª…ì„¸ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                }

                // ì˜ˆì‹œ (ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ê°€ ìˆë‹¤ë©´ ì²« ë²ˆì§¸ ê²ƒì„ ì˜ˆì‹œë¡œ ì‚¬ìš©)
                const exampleEl = document.getElementById('taskExample');
                if (exampleEl) {
                    // ê¸°ë³¸ ì˜ˆì‹œ í…ìŠ¤íŠ¸
                    exampleEl.textContent = 'ì…ì¶œë ¥ ì˜ˆì‹œê°€ ì œê³µë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
                }
            }

            resetResultPanels() {
                // ì¶œë ¥ ì˜ì—­ ì´ˆê¸°í™”
                const outputContent = document.getElementById('outputContent');
                if (outputContent) {
                    outputContent.textContent = '';
                }

                // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ íŒ¨ë„ ìˆ¨ê¸°ê¸°
                const testCasePanel = document.getElementById('testCasePanel');
                if (testCasePanel) {
                    testCasePanel.style.display = 'none';
                }

                // ì ìˆ˜ ë° í”¼ë“œë°± ìˆ¨ê¸°ê¸°
                const scoreDisplay = document.getElementById('scoreDisplay');
                const feedbackButton = document.getElementById('feedbackButton');
                if (scoreDisplay) scoreDisplay.style.display = 'none';
                if (feedbackButton) feedbackButton.style.display = 'none';
            }

            showSubmissionResult() {
                if (!this.currentSubmission) return;

                const scoreDisplay = document.getElementById('scoreDisplay');
                const feedbackButton = document.getElementById('feedbackButton');

                if (this.currentSubmission.score !== null) {
                    if (scoreDisplay) {
                        scoreDisplay.textContent = `ì ìˆ˜: ${this.currentSubmission.score}/100`;
                        scoreDisplay.style.display = 'inline-block';
                    }

                    if (this.currentSubmission.feedback && feedbackButton) {
                        feedbackButton.style.display = 'inline-block';
                    }
                }
            }

            // Blockly ì´ˆê¸°í™”
            initBlockly() {
                this.workspace = Blockly.inject('blocklyDiv', {
                    toolbox: document.getElementById('toolbox'),
                    grid: {
                        spacing: 20,
                        length: 3,
                        colour: '#ccc',
                        snap: true
                    },
                    zoom: {
                        controls: true,
                        wheel: true,
                        startScale: 1.0,
                        maxScale: 3,
                        minScale: 0.3,
                        scaleSpeed: 1.2
                    },
                    trashcan: true
                });

                // ì½”ë“œ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                this.workspace.addChangeListener(() => {
                    this.updateCode();
                });
            }

            setupEventListeners() {
                // ì—ë””í„° íƒ­ ì „í™˜
                document.querySelectorAll('.editor-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const mode = e.target.getAttribute('data-editor');
                        this.switchEditorMode(mode);
                        
                        // íƒ­ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                        document.querySelectorAll('.editor-tab').forEach(t => t.classList.remove('active'));
                        e.target.classList.add('active');
                    });
                });

                // ì–¸ì–´ ë²„íŠ¼
                document.querySelectorAll('.language-button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        document.querySelectorAll('.language-button').forEach(b => {
                            b.classList.remove('active-language');
                            b.classList.add('inactive-language');
                        });
                        e.target.classList.remove('inactive-language');
                        e.target.classList.add('active-language');
                        this.updateCode();
                    });
                });

                // ì‹¤í–‰ ë²„íŠ¼
                const runButton = document.getElementById('runButton');
                if (runButton) {
                    runButton.addEventListener('click', () => {
                        this.runCode();
                    });
                }

                // í…ŒìŠ¤íŠ¸ ë²„íŠ¼
                const testButton = document.getElementById('testButton');
                if (testButton) {
                    testButton.addEventListener('click', () => {
                        this.runTests();
                    });
                }

                // ì œì¶œ ë²„íŠ¼
                const submitButton = document.getElementById('submitButton');
                if (submitButton) {
                    submitButton.addEventListener('click', () => {
                        this.submitAssignment();
                    });
                }

                // ê²€ìƒ‰ ê¸°ëŠ¥
                const searchBox = document.getElementById('searchBox');
                if (searchBox) {
                    searchBox.addEventListener('input', (e) => {
                        this.searchAssignments(e.target.value);
                    });
                }

                // ì¹´í…Œê³ ë¦¬ íƒ­
                document.querySelectorAll('.category-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const category = e.target.getAttribute('data-category');
                        this.filterAssignments(category);
                        
                        // íƒ­ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                        document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                        e.target.classList.add('active');
                    });
                });

                // ëª¨ë‹¬ ì´ë²¤íŠ¸
                this.setupModalEvents();
            }

            setupModalEvents() {
                const modal = document.getElementById('feedbackModal');
                const closeModal = document.getElementById('closeModal');
                const confirmModal = document.getElementById('confirmModal');
                const feedbackButton = document.getElementById('feedbackButton');

                if (feedbackButton) {
                    feedbackButton.addEventListener('click', () => {
                        this.showFeedbackModal();
                    });
                }

                if (closeModal) {
                    closeModal.addEventListener('click', () => {
                        modal.style.display = 'none';
                    });
                }

                if (confirmModal) {
                    confirmModal.addEventListener('click', () => {
                        modal.style.display = 'none';
                    });
                }

                window.addEventListener('click', (event) => {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }

            switchEditorMode(mode) {
                const blocklyDiv = document.getElementById('blocklyDiv');
                const codeView = document.getElementById('codeView');

                if (mode === 'block') {
                    blocklyDiv.style.display = 'block';
                    codeView.style.display = 'none';
                    this.currentEditorMode = 'block';
                } else if (mode === 'code') {
                    blocklyDiv.style.display = 'none';
                    codeView.style.display = 'block';
                    this.currentEditorMode = 'code';
                    
                    // ì½”ë“œ ë·° ì—…ë°ì´íŠ¸
                    const code = this.getGeneratedCode();
                    codeView.textContent = code;
                }
            }

            getGeneratedCode() {
                if (!this.workspace) return '';

                const pythonButton = document.getElementById('pythonButton');
                let code = '';

                if (pythonButton && pythonButton.classList.contains('active-language')) {
                    // Python ì½”ë“œ ìƒì„±
                    try {
                        code = Blockly.JavaScript.workspaceToCode(this.workspace);
                    } catch (e) {
                        code = '// ì½”ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n// ' + e.message;
                    }
                }

                return code;
            }

            updateCode() {
                const code = this.getGeneratedCode();
                const codeContent = document.getElementById('codeContent');
                if (codeContent) {
                    codeContent.textContent = code;
                }

                // ì½”ë“œ ë·° ëª¨ë“œì¸ ê²½ìš° ì½”ë“œ ë·°ë„ ì—…ë°ì´íŠ¸
                if (this.currentEditorMode === 'code') {
                    const codeView = document.getElementById('codeView');
                    if (codeView) {
                        codeView.textContent = code;
                    }
                }
            }

            runCode() {
                if (!this.workspace) return;

                const outputContent = document.getElementById('outputContent');
                if (!outputContent) return;

                // ì¶œë ¥ ì˜ì—­ ì´ˆê¸°í™”
                outputContent.textContent = '';

                // ì ìˆ˜ ë° í”¼ë“œë°± ìˆ¨ê¸°ê¸°
                const scoreDisplay = document.getElementById('scoreDisplay');
                const feedbackButton = document.getElementById('feedbackButton');
                const testCasePanel = document.getElementById('testCasePanel');
                
                if (scoreDisplay) scoreDisplay.style.display = 'none';
                if (feedbackButton) feedbackButton.style.display = 'none';
                if (testCasePanel) testCasePanel.style.display = 'none';

                try {
                    // í˜„ì¬ ì„ íƒëœ ì–¸ì–´ í™•ì¸
                    const pythonButton = document.getElementById('pythonButton');
                    const isPython = pythonButton && pythonButton.classList.contains('active-language');
                    
                    let code;
                    if (isPython) {
                        // Python ì½”ë“œ í‘œì‹œ
                        const pythonCode = Blockly.Python.workspaceToCode(this.workspace);
                        outputContent.textContent += 'â€» Python ì½”ë“œ:\n\n' + pythonCode + '\n\n';
                        outputContent.textContent += 'â€» ì‹¤í–‰ ê²°ê³¼ (JavaScriptë¡œ ì‹¤í–‰):\n\n';
                        
                        // JavaScript ì½”ë“œë¡œ ì‹¤í–‰
                        code = Blockly.JavaScript.workspaceToCode(this.workspace);
                    } else {
                        // JavaScript ì½”ë“œ
                        code = Blockly.JavaScript.workspaceToCode(this.workspace);
                    }

                    // ì½˜ì†” ì¶œë ¥ì„ ìº¡ì²˜í•˜ê¸° ìœ„í•´ console.log ì„ì‹œ ì¬ì •ì˜
                    const originalConsoleLog = console.log;
                    console.log = function () {
                        const args = Array.from(arguments);
                        outputContent.textContent += args.join(' ') + '\n';
                        originalConsoleLog.apply(console, arguments);
                    };

                    // ì‚¬ìš©ì ì…ë ¥ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ìœ„í•œ prompt ì¬ì •ì˜
                    const originalPrompt = window.prompt;
                    window.prompt = function (text) {
                        const result = originalPrompt(text);
                        outputContent.textContent += `ì…ë ¥: ${result}\n`;
                        return result;
                    };

                    // JavaScript ì½”ë“œ ì‹¤í–‰
                    new Function(code)();

                    // ì›ë˜ í•¨ìˆ˜ ë³µì›
                    console.log = originalConsoleLog;
                    window.prompt = originalPrompt;

                    navigationManager.showNotification('ì½”ë“œê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } catch (e) {
                    // ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²½ìš°
                    outputContent.textContent += 'ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + e.message;
                    console.error('Code execution error:', e);
                    navigationManager.showNotification('ì½”ë“œ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            runTests() {
                if (!this.currentAssignment || !this.workspace) {
                    navigationManager.showNotification('ê³¼ì œê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                // ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì™€ì•¼ í•˜ë¯€ë¡œ ê¸°ë³¸ í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
                const outputContent = document.getElementById('outputContent');
                const testCaseContent = document.getElementById('testCaseContent');
                const testCasePanel = document.getElementById('testCasePanel');
                
                if (!outputContent || !testCaseContent || !testCasePanel) return;

                // ì–¸ì–´ì— ê´€ê³„ì—†ì´ í•­ìƒ JavaScript ì½”ë“œë¥¼ ì–»ì–´ì„œ ì‹¤í–‰
                const code = Blockly.JavaScript.workspaceToCode(this.workspace);

                // ì¶œë ¥ ì˜ì—­ ì´ˆê¸°í™”
                outputContent.textContent = '';
                testCaseContent.innerHTML = '';

                // Python ëª¨ë“œì¸ ê²½ìš° Python ì½”ë“œë„ í‘œì‹œ
                const pythonButton = document.getElementById('pythonButton');
                const isPython = pythonButton && pythonButton.classList.contains('active-language');
                if (isPython) {
                    const pythonCode = Blockly.Python.workspaceToCode(this.workspace);
                    outputContent.textContent += 'â€» Python ì½”ë“œ:\n\n' + pythonCode + '\n\n';
                    outputContent.textContent += 'â€» í…ŒìŠ¤íŠ¸ ê²°ê³¼ (JavaScriptë¡œ ì‹¤í–‰):\n\n';
                }

                // í…ŒìŠ¤íŠ¸ íŒ¨ë„ í‘œì‹œ
                testCasePanel.style.display = 'block';

                // ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
                const defaultTestCases = [
                    { input: '3', expectedOutput: 'ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤' },
                    { input: '5', expectedOutput: 'í™•ì¥ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤' }
                ];

                let passedCount = 0;
                this.testResults = [];

                for (let i = 0; i < defaultTestCases.length; i++) {
                    const testCase = defaultTestCases[i];

                    try {
                        // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í•­ëª© ìƒì„±
                        const testItem = document.createElement('div');
                        testItem.className = 'test-case-item';

                        // ì½˜ì†” ì¶œë ¥ ìº¡ì²˜
                        const originalConsoleLog = console.log;
                        let outputLines = [];
                        console.log = function () {
                            const args = Array.from(arguments);
                            outputLines.push(args.join(' '));
                            originalConsoleLog.apply(console, arguments);
                        };

                        // í”„ë¡¬í”„íŠ¸ ëŒ€ì²´ (í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ì…ë ¥ ì‚¬ìš©)
                        const originalPrompt = window.prompt;
                        window.prompt = function () {
                            return testCase.input;
                        };

                        // ì½”ë“œ ì‹¤í–‰
                        new Function(code)();

                        // ì›ë˜ í•¨ìˆ˜ ë³µì›
                        console.log = originalConsoleLog;
                        window.prompt = originalPrompt;

                        // ì¶œë ¥ ë¹„êµ (ê¸°ë³¸ì ìœ¼ë¡œ í†µê³¼ë¡œ ì²˜ë¦¬)
                        const output = outputLines.join('\n');
                        const isPassed = true; // ì‹¤ì œë¡œëŠ” ì„œë²„ ì¸¡ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì™€ ë¹„êµí•´ì•¼ í•¨

                        // ê²°ê³¼ ì €ì¥
                        this.testResults.push({
                            input: testCase.input,
                            output: output,
                            expected: testCase.expectedOutput,
                            passed: isPassed
                        });

                        // í†µê³¼ ì—¬ë¶€ì— ë”°ë¼ UI ì—…ë°ì´íŠ¸
                        const badgeDiv = document.createElement('div');
                        badgeDiv.className = 'test-case-badge ' + (isPassed ? 'badge-success' : 'badge-error');

                        const textDiv = document.createElement('div');
                        textDiv.textContent = `í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ${i + 1}: ${testCase.input} => ${isPassed ? 'í†µê³¼' : 'ì‹¤íŒ¨'}`;

                        testItem.appendChild(badgeDiv);
                        testItem.appendChild(textDiv);
                        testCaseContent.appendChild(testItem);

                        if (isPassed) {
                            passedCount++;
                        }
                    } catch (e) {
                        // ì˜¤ë¥˜ ë°œìƒ ì‹œ
                        const testItem = document.createElement('div');
                        testItem.className = 'test-case-item';

                        const badgeDiv = document.createElement('div');
                        badgeDiv.className = 'test-case-badge badge-error';

                        const textDiv = document.createElement('div');
                        textDiv.textContent = `í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ${i + 1}: ì˜¤ë¥˜ ë°œìƒ - ${e.message}`;

                        testItem.appendChild(badgeDiv);
                        testItem.appendChild(textDiv);
                        testCaseContent.appendChild(testItem);

                        // ê²°ê³¼ ì €ì¥
                        this.testResults.push({
                            input: testCase.input,
                            output: 'ì˜¤ë¥˜: ' + e.message,
                            expected: testCase.expectedOutput,
                            passed: false
                        });
                    }
                }

                // ì ìˆ˜ ê³„ì‚° ë° í‘œì‹œ
                const score = Math.round((passedCount / defaultTestCases.length) * 100);
                const scoreDisplay = document.getElementById('scoreDisplay');
                const feedbackButton = document.getElementById('feedbackButton');
                
                if (scoreDisplay) {
                    scoreDisplay.textContent = `ì ìˆ˜: ${score}/100`;
                    scoreDisplay.style.display = 'inline-block';
                }

                // í”¼ë“œë°± ë²„íŠ¼ í‘œì‹œ
                if (feedbackButton) {
                    feedbackButton.style.display = 'inline-block';
                }

                // ê²°ê³¼ ìš”ì•½ í‘œì‹œ
                outputContent.textContent += `í…ŒìŠ¤íŠ¸ ê²°ê³¼: ${passedCount}/${defaultTestCases.length} í†µê³¼ (${score}ì )\n\n`;
                outputContent.textContent += 'â€» ìì„¸í•œ ê²°ê³¼ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ íŒ¨ë„ì„ í™•ì¸í•˜ì„¸ìš”.';

                navigationManager.showNotification('í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }

            async submitAssignment() {
                if (!this.currentAssignment || !this.workspace) {
                    navigationManager.showNotification('ê³¼ì œê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                // ë¸”ë¡ì´ ìˆëŠ”ì§€ í™•ì¸
                const topBlocks = this.workspace.getTopBlocks();
                if (topBlocks.length === 0) {
                    navigationManager.showNotification('ì œì¶œí•  ë¸”ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì½”ë“œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.', 'error');
                    return;
                }

                // ì‚¬ìš©ìì—ê²Œ ì œì¶œ í™•ì¸
                if (!confirm('ê³¼ì œë¥¼ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì œì¶œ í›„ì—ë„ ìˆ˜ì •í•˜ì—¬ ì¬ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {
                    return;
                }

                try {
                    navigationManager.showLoading();

                    // ì½”ë“œ ë°ì´í„° ì¤€ë¹„
                    let blockXml = '';
                    let jsCode = '';
                    let pythonCode = '';

                    try {
                        // Blockly XML ì§ë ¬í™”
                        const blockData = Blockly.Xml.workspaceToDom(this.workspace);
                        blockXml = Blockly.Xml.domToText(blockData);
                        
                        // JavaScript ì½”ë“œ ìƒì„±
                        jsCode = Blockly.JavaScript.workspaceToCode(this.workspace) || '';
                        
                        // Python ì½”ë“œ ìƒì„±  
                        pythonCode = Blockly.Python.workspaceToCode(this.workspace) || '';
                        
                        console.log('Generated codes:', { blockXml, jsCode, pythonCode });
                        
                    } catch (codeGenError) {
                        console.error('ì½”ë“œ ìƒì„± ì˜¤ë¥˜:', codeGenError);
                        throw new Error('ì½”ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + codeGenError.message);
                    }

                    // ì œì¶œ ë°ì´í„° êµ¬ì„±
                    const submissionData = {
                        submission_data: JSON.stringify({
                            blocks: blockXml,
                            javascript_code: jsCode,
                            python_code: pythonCode,
                            block_count: topBlocks.length,
                            timestamp: new Date().toISOString()
                        })
                    };

                    console.log('Submitting assignment:', this.currentAssignment.assignment_id, submissionData);

                    const token = localStorage.getItem('authToken');
                    if (!token) {
                        throw new Error('ì¸ì¦ í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                    }

                    const response = await fetch(`/api/assignments/${this.currentAssignment.assignment_id}/submit`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + token
                        },
                        body: JSON.stringify(submissionData)
                    });

                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('Response error:', errorText);
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }

                    const result = await response.json();
                    console.log('Submit result:', result);

                    if (result.success) {
                        navigationManager.showNotification('ê³¼ì œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
                        
                        // ì œì¶œ ìƒíƒœ ì—…ë°ì´íŠ¸
                        this.currentSubmission = {
                            submission_id: result.submission_id || Date.now(), // ì„ì‹œ ID
                            submitted_at: new Date().toISOString(),
                            score: null,
                            graded_at: null,
                            feedback: null
                        };

                        // í˜„ì¬ ê³¼ì œ ê°ì²´ ì—…ë°ì´íŠ¸
                        this.currentAssignment.submission = this.currentSubmission;
                        
                        // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        const currentItem = document.querySelector(`[data-assignment-id="${this.currentAssignment.assignment_id}"]`);
                        if (currentItem) {
                            const statusEl = currentItem.querySelector('.task-status');
                            if (statusEl) {
                                statusEl.className = 'task-status status-submitted';
                                statusEl.textContent = 'ì œì¶œì™„ë£Œ';
                            }
                        }

                        // ê³¼ì œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ë¹„ë™ê¸°ë¡œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ)
                        setTimeout(() => {
                            this.loadAssignments().catch(console.error);
                        }, 1000);
                        
                    } else {
                        throw new Error(result.message || 'ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('ì œì¶œ ì˜¤ë¥˜:', error);
                    
                    // êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ì œê³µ
                    let errorMessage = 'ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                    
                    if (error.message.includes('HTTP 401')) {
                        errorMessage = 'ë¡œê·¸ì¸ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.';
                    } else if (error.message.includes('HTTP 403')) {
                        errorMessage = 'ì œì¶œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.';
                    } else if (error.message.includes('HTTP 404')) {
                        errorMessage = 'ê³¼ì œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    } else if (error.message.includes('HTTP 400')) {
                        errorMessage = 'ì œì¶œ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    } else if (error.message) {
                        errorMessage = error.message;
                    }
                    
                    navigationManager.showNotification(errorMessage, 'error');
                } finally {
                    navigationManager.hideLoading();
                }
            }

            searchAssignments(keyword) {
                const taskItems = document.querySelectorAll('.task-item');

                if (!keyword) {
                    // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ëª¨ë“  ê³¼ì œ í‘œì‹œ
                    taskItems.forEach(item => {
                        item.style.display = 'block';
                    });
                    return;
                }

                keyword = keyword.toLowerCase();

                // ê²€ìƒ‰ì–´ë¡œ ê³¼ì œ í•„í„°ë§
                taskItems.forEach(item => {
                    const title = item.querySelector('.task-title').textContent.toLowerCase();
                    const meta = item.querySelector('.task-meta').textContent.toLowerCase();

                    if (title.includes(keyword) || meta.includes(keyword)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            }

            filterAssignments(category) {
                const taskItems = document.querySelectorAll('.task-item');

                taskItems.forEach(item => {
                    const statusEl = item.querySelector('.task-status');
                    const statusClass = statusEl ? statusEl.className : '';

                    let shouldShow = false;

                    switch (category) {
                        case 'all':
                            shouldShow = true;
                            break;
                        case 'pending':
                            shouldShow = statusClass.includes('status-pending');
                            break;
                        case 'submitted':
                            shouldShow = statusClass.includes('status-submitted') || statusClass.includes('status-graded');
                            break;
                    }

                    item.style.display = shouldShow ? 'block' : 'none';
                });
            }

            showFeedbackModal() {
                const modal = document.getElementById('feedbackModal');
                const feedbackContent = document.getElementById('feedbackContent');

                if (!modal || !feedbackContent) return;

                let feedback = '';

                // ê¸°ë³¸ í”¼ë“œë°± ìƒì„±
                if (this.currentSubmission && this.currentSubmission.feedback) {
                    feedback = this.currentSubmission.feedback;
                } else {
                    // í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê¸°ë°˜ í”¼ë“œë°± ìƒì„±
                    if (this.testResults.length > 0) {
                        const passedCount = this.testResults.filter(result => result.passed).length;
                        const score = Math.round((passedCount / this.testResults.length) * 100);

                        if (score >= 90) {
                            feedback += '<p><strong>ğŸ‰ í›Œë¥­í•©ë‹ˆë‹¤!</strong> ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì„±ê³µì ìœ¼ë¡œ í†µê³¼í–ˆìŠµë‹ˆë‹¤.</p>';
                        } else if (score >= 70) {
                            feedback += '<p><strong>ğŸ‘ ì¢‹ì€ ì‹œë„ì…ë‹ˆë‹¤!</strong> ëŒ€ë¶€ë¶„ì˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í–ˆìŠµë‹ˆë‹¤.</p>';
                        } else if (score >= 40) {
                            feedback += '<p><strong>ğŸ” ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.</strong> ì¼ë¶€ í…ŒìŠ¤íŠ¸ë§Œ í†µê³¼í–ˆìŠµë‹ˆë‹¤.</p>';
                        } else {
                            feedback += '<p><strong>â— ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.</strong> ëŒ€ë¶€ë¶„ì˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>';
                        }

                        // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì„¸ë¶€ ê²°ê³¼
                        if (this.testResults.length > 0) {
                            feedback += '<p><strong>ğŸ“Š í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê²°ê³¼:</strong></p>';
                            feedback += '<ul>';

                            for (let i = 0; i < this.testResults.length; i++) {
                                const result = this.testResults[i];
                                const icon = result.passed ? 'âœ…' : 'âŒ';

                                feedback += `<li>${icon} í…ŒìŠ¤íŠ¸ ${i + 1} (ì…ë ¥: ${result.input}):</li>`;

                                if (!result.passed) {
                                    feedback += `<ul>`;
                                    feedback += `<li>ê¸°ëŒ€ ì¶œë ¥: ${result.expected}</li>`;
                                    feedback += `<li>ì‹¤ì œ ì¶œë ¥: ${result.output}</li>`;
                                    feedback += `</ul>`;
                                }
                            }

                            feedback += '</ul>';
                        }
                    } else {
                        feedback = '<p>ì•„ì§ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.</p>';
                    }
                }

                feedbackContent.innerHTML = feedback;
                modal.style.display = 'block';
            }
        }

        // ë””ë²„ê¹…ì„ ìœ„í•œ ì „ì—­ í•¨ìˆ˜ë“¤
        window.debugAssignment = function() {
            console.log('Current assignment:', assignmentManager?.currentAssignment);
            console.log('Current workspace blocks:', assignmentManager?.workspace?.getTopBlocks().length);
            console.log('Auth token exists:', !!localStorage.getItem('authToken'));
            console.log('User info:', JSON.parse(localStorage.getItem('user') || '{}'));
        };

        window.testSubmission = async function() {
            if (assignmentManager) {
                console.log('Testing submission...');
                await assignmentManager.submitAssignment();
            }
        };

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM loaded, initializing...');
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë§¤ë‹ˆì € ì´ˆê¸°í™”
            navigationManager = new NavigationManager();
            navigationManager.setupKeyboardShortcuts();

            // ê³¼ì œ ê´€ë¦¬ì ì´ˆê¸°í™”
            assignmentManager = new AssignmentManager();
            
            console.log('Initialization complete');
        });

        // Blockly ì›¹í˜ì´ì§€ í¬ê¸° ì¡°ì • ì‹œ ìë™ ë¦¬ì‚¬ì´ì§•
        window.addEventListener('resize', function () {
            if (assignmentManager && assignmentManager.workspace) {
                Blockly.svgResize(assignmentManager.workspace);
            }
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'r':
                        e.preventDefault();
                        if (assignmentManager) {
                            assignmentManager.runCode();
                        }
                        break;
                    case 't':
                        e.preventDefault();
                        if (assignmentManager) {
                            assignmentManager.runTests();
                        }
                        break;
                    case 's':
                        e.preventDefault();
                        if (assignmentManager) {
                            assignmentManager.submitAssignment();
                        }
                        break;
                }
            }
        });

        // í˜ì´ì§€ ì´íƒˆ ì‹œ í™•ì¸
        window.addEventListener('beforeunload', function (e) {
            if (assignmentManager && assignmentManager.workspace && assignmentManager.workspace.getAllBlocks(false).length > 0) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>.Python.workspaceToCode(this.workspace);
                    } catch (e) {
                        code = '# ì½”ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n# ' + e.message;
                    }
                } else {
                    // JavaScript ì½”ë“œ ìƒì„±
                    try {
                        code = Blockly